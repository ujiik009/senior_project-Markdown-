<!DOCTYPE html>
<html>
<head>
	<title>Markdown Editor </title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap.min.css"/>
	<link rel="stylesheet" type="text/css" href="lib/css/jquery.numberedtextarea.css">
	<link rel="stylesheet" href="lib/css/agate.min.css">

	<style type="text/css">
		body{
			/*rgba(0, 0, 0, 0.8)*/
			background-color: #362E04;
		}
		.col-md-6{
			padding: 0px;
			/*background-color: #c0c2e5;*/
			height: auto;
		}
		.box{
			padding: 5px;
			height: auto;
			

		}
		.io{ 

			/*padding: 20px;*/
			width: 100%;
			height: 41vw;
			background-color: #FFFCEB;
			overflow: scroll;
		}
		.output{
			padding: 20px;
		}
		hr { 
		    display: block;
		    margin-top: 0.5em;
		    margin-bottom: 0.5em;
		    margin-left: auto;
		    margin-right: auto;
		    border-style: inset;
		    border-width: 1px;
		} 
		pre{
			width: auto;
			height: auto;
			background-color: #333;
			overflow-x:auto;

		}
		code{
			height: inherit;
			

		}

	</style>
</head>
<body>
<!-- navbar start < -->
<nav class="navbar navbar-inverse">
  <div class="container-fluid">
    <div class="navbar-header">
      <a class="navbar-brand" href="#" >M<span class="glyphicon glyphicon-arrow-down"></span> </a>
    </div>

    <ul class="nav navbar-nav">
      <li class="active"><a href="#">Home</a></li>
      <li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" href="#">Page 1 <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a href="#">Page 1-1</a></li>
          <li><a href="#">Page 1-2</a></li>
          <li><a href="#">Page 1-3</a></li>
        </ul>
      </li>
      <li><a href="#">Page 2</a></li>
    </ul>
    <ul class="nav navbar-nav navbar-right">
      <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
      <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
    </ul>
  </div>
</nav>
<!-- navbar stop > -->



<div class="row">
  <div class="col-md-6">
  	<div class="box">
  		<textarea class="input io"></textarea>
  	</div>
  </div>
  <div class="col-md-6">
  	<div class="box">
  		<div class="output io"></div>
  	</div>
  </div>
</div>

</body>
<script type="text/javascript" src="lib/js/jquery-3.1.1.js"></script>
<script type="text/javascript" src="lib/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="lib/js/jquery.numberedtextarea.js"></script>
<script type="text/javascript" src="lib/js/tab.js"></script>

<script src="lib/js/highlight.min.js"></script>
<script type="text/javascript">
$( document ).ready(function() {
	// || ice || ice || ice ||
	// |:---:|:---:|:---:|
	// | sds | sds | dsds |
	// </table>

	// || ice || ice || ice ||
	// |:---:|:---:|:---:|
	// | sds | sds | dsds |
	// </table>


	 $(".input").numberedtextarea().enableSmartTab();

	hljs.initHighlightingOnLoad();
	$(".input").keyup(function(){
		
		$(".output").html(regexMD_to_html($(".input").val())),highlight();
	});
	var html;
	var template = "<html><meta charset='utf-8'><head></head><body><??content??></body></html>";
	function regexMD_to_html(text){
		
		var objpatt = {
			 pattH1 		: /(#{1})(.+)?/gm,
			 pattH2 		: /(#{2})(.+)?/gm,
			 pattH3 		: /(#{3})(.+)?/gm,
			 pattH4 		: /(#{4})(.+)?/gm,
			 pattH5 		: /(#{5})(.+)?/gm,
			 pattH6 		: /(#{6})(.+)?/gm,
			 pattheadder1	: /([A-z0-9ก-๙]+)\n={2,}/gm,
			 pattheadder2	: /([A-z0-9ก-๙]+)\n\-{2,}/gm,
			 pattlink 		: /(\[(.*?)\]\()(.+?)(\))/gm,
			 patthorizontal : /-{3,}/gm,
			 pattnewline 	: /^\n/mg,
			 pattStrong 	: /(\*\*|__)(.*?)\1/gm,
			 pattitalics 	: /(\*\*\*|___|\/\/\/)(.*?)\1/gm,
			 pattimgOption 	: /!\[(.*)\]\((.+)\)\((.+)\)\((.+)\)/gm,
			 pattimg 		: /!\[(.*)\]\((.+)\)/gm,
			 patttlist      : /\* (.*)/gm,
			 pattcode_block : /```(\w+)*\n([\s\S]*?)\n{1,}```/g,
			 pattTableth	: /[|][|](\s+[A-Za-z0-9 -_*#@$%:;?!.,\/\\]+\s+)[|]?[|]?(\s+[A-Za-z0-9 -_*#@$%:;?!.,\/\\]+\s+)[|]?[|]?(\s+[A-Za-z0-9 -_*#@$%:;?!.,\/\\]+\s+)[|]?[|]?\r?\n?\|?:-+:\|?:-+:\|?:-+:\|?/gm,
			 pattTableC 	: /[|](\s+[A-Za-z0-9 -_*#@$%:;?!.,\/\\]+\s+)[|](\s+[A-Za-z0-9 -_*#@$%:;?!.,\/\\]+\s+)[|](\s+[A-Za-z0-9 -_*#@$%:;?!.,\/\\]+\s+)[|]?\r?\n?/gm
			 
			
		}
		// text = text.match(pattH1);
		text = 
		text.replace(objpatt.pattTableth,"<table border=1>\n<tr>\n\t<th>$1</th>\n\t<th>$2</th>\n\t<th>$3</th>\n</tr>")
			.replace(objpatt.pattTableC,"\n<tr>\n\t<td>$1</td>\n\t<td>$2</td>\n\t<td>$3</td>\n</tr>")		
			.replace(objpatt.pattH6,"<h6>\n\t$2\n</h6>\n")
			.replace(objpatt.pattH5,"<h5>\n\t$2\n</h5>\n")
			.replace(objpatt.pattH4,"<h4>\n\t$2\n</h4>\n")
			.replace(objpatt.pattH3,"<h3>\n\t$2\n</h3>\n")
			.replace(objpatt.pattH2,"<h2>\n\t$2\n</h2>\n")
			.replace(objpatt.pattH1,"<h1>\n\t$2\n</h1>\n")
			.replace(objpatt.pattheadder1,"<h1>$1</h1>")
			.replace(objpatt.pattheadder2,"<h2>$1</h2>")
			.replace(objpatt.patthorizontal,"<hr />")
			.replace(objpatt.pattitalics,"<em>$2</em>")
			.replace(objpatt.pattStrong,"<strong>$2</strong>")
			.replace(objpatt.pattimgOption,'<img src="$2" alt="$1" style="width:$3px;height:$4px;"/>')
			.replace(objpatt.pattimg,'<img src="$2" alt="$1" />')
			.replace(objpatt.pattlink,"<a href='$3'>$2</a>")
			.replace(objpatt.patttlist,"<ul><li>$1</li></ul>")
			.replace(objpatt.pattcode_block,"<pre><code class ='$1'>$2</code></pre>")
			.replace(objpatt.pattnewline,"</br>")

			
			
		html = text;	
		//return text;
		//console.log(template.replace("<??content??>",text));
		//alert(template.replace("<??content??>",text));
		return template.replace("<??content??>",text);
	}
	function highlight(){
		$('pre code').each(function(i, block) {
		    hljs.highlightBlock(block);
		});
	}

	$("button").click(function(){
		alert(html);
	})

});
</script>

</html>




